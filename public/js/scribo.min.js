var scribo=scribo||{};scribo.config=scribo.config||{},$(function(){scribo.AppView=Backbone.View.extend({el:$("main"),initialize:function(){scribo.cards=new scribo.CardCollection,this.listenTo(scribo.cards,"add",this.addOne),this.listenTo(scribo.cards,"reset",this.addAll),scribo.cards.fetch({reset:!0}),this.$cards=this.$el.find("#cards"),this.makeSortable(),this.addNav()},makeSortable:function(){this.$cards.sortable({cancel:""}).on("click",function(a){$(a.target).focus()})},events:{"click a.add-card":"addCard"},addCard:function(a){a.preventDefault(),scribo.cards.create()},addOne:function(a){var b=new scribo.CardItemView({model:a});this.$cards.append(b.render().el)},addAll:function(){scribo.cards.each(this.addOne,this)},addNav:function(){var a=new scribo.NavView;this.$el.append(a.render().el)}}),scribo.CardItemView=Backbone.View.extend({tagName:"li",className:"card",template:_.template($("#card-template").html()),render:function(){return this.$el.html(this.template(this.model.toJSON())),this.$input=this.$el.find("textarea"),this},initialize:function(){this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"change:color",this.render),this.listenTo(this.model,"change:text",this.throttledSave)},events:{"keyup textarea":"updateCardText","click a.delete-card":"deleteCard","click a.set-card-style":"setCardStyle"},updateCardText:function(){var a=this.$input.val()?this.$input.val():"";this.model.set({text:a})},deleteCard:function(a){a.preventDefault(),this.model.destroy()},setCardStyle:function(a){a.preventDefault(),this.model.save("color",$(a.target).attr("href"))},throttledSave:_.throttle(function(){this.model.save()},scribo.config.autosave_ms)}),scribo.NavView=Backbone.View.extend({tagName:"nav",template:_.template($("#nav-template").html()),render:function(){return this.$el.html(this.template()),this},events:{"click .toggle":function(){$("body").toggleClass("nav-open")},'change input[name="theme"]':function(a){$("body").toggleClass("modern","modern"===$(a.target).val()),$("body").toggleClass("classic","classic"===$(a.target).val())}}}),new scribo.AppView});var scribo=scribo||{};scribo.config=scribo.config||{},scribo.config.autosave_ms=5e3;var scribo=scribo||{};scribo.CardModel=Backbone.Model.extend({defaults:{color:1,text:""},idAttribute:"_id"}),scribo.CardCollection=Backbone.Collection.extend({model:scribo.CardModel,url:"/api/cards"});var scribo=scribo||{},scribo=scribo||{};
//# sourceMappingURL=scribo.min.js.map