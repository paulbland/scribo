<html>
<head>
	<meta charset="UTF-8">

	<link href='http://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet' type='text/css'>
	<link href='http://fonts.googleapis.com/css?family=Just+Another+Hand' rel='stylesheet' type='text/css'>

	<script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
	<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script>






	<script>
	var app = app || {};

	$(function() {
	

	// Model
	app.CardModel = Backbone.Model.extend({});

	// Collection
	app.CardCollection = Backbone.Collection.extend({
	  	model: app.CardModel,
	  	url: '/cards.json'
	});

	// Create new collectino
 	app.cards = new app.CardCollection();

 	// get cards collection
	app.cards.fetch();




  app.AppView = Backbone.View.extend({
     el: $('#cards'),


     initialize: function() {

			this.listenTo(app.cards, 'reset', this.addAll);
			
     		app.cards.fetch({reset: true});


        },


		addOne: function (card) {
			var view = new app.CardView({ model: card });
			this.$el.append(view.render().el);
		},

		// Add all items in the **Todos** collection at once.
		addAll: function () {

		
			app.cards.each(this.addOne, this);
			_makeDraggable();
		}
});


  app.CardView = Backbone.View.extend({

     template: _.template( $('#card-template').html() ),

     render: function () {

     				this.$el.html(this.template(this.model.toJSON()));
     				return this;
     			}

  });


 new app.AppView();




var _makeDraggable= function() {
		var cards = $('.card');

		var zIndex = cards.length;

		var _dragStart = function(event, ui) {
			$(this).addClass('dragging');
			$(this).css({"zIndex": ++zIndex});
		};
		var _dragStop = function(event, ui) {
			$(this).removeClass('dragging');
		};

		cards.draggable(); 
		cards.on("mousedown", _dragStart);
		cards.on("mouseup", _dragStop);

}
		
	});
	</script>

	<style>
		body {
			font-family: Ubuntu;
			margin:0;
			padding: 0;
			background: #E0DFE1;
		}
		header {
			background: #4BC5FC;
			color: white;
			}
			header h1 {
				font-size: 18px;
				padding: 5px 10px;
				margin: 0;
				}

		main {
			}
			main .card {
				position: absolute;
				padding: 31px 10px 10px;
				color: black;
			  	text-overflow: ellipsis;
			    background-image: linear-gradient(0deg, rgba(255,255,255,0.25) 0.05em, rgba(0,0,0,0) 0.05em);
			 	background-color: white;
				background-size: 100% 20px;
				cursor: pointer;
				box-shadow: 0 2px 3px rgba(0,0,0,0.4);
				transition: margin 150ms ease-out;
			}
			main .card.dragging {
				box-shadow: 0 6px 9px rgba(0,0,0,0.2);
				margin-top: -5px;
				transition: margin 85ms ease-out;
			} 
			main .card textarea {
				margin: 0;
				padding: 0;
				font-family: 'Just Another Hand';
				font-size: 40px;
				border: none;
				background: transparent;
				width: 300px;
				height: 150px;
				outline: none;
				line-height: 40px;
				letter-spacing: 0.5px;
				resize: none;
			}
			main .card textarea:focus {
				outline: 2px dotted rgba(0,255,0,0.85);
			}

			main .card.color-1 {
				background-color: #fded64;
			}
			main .card.color-2 {
				background-color: #9ec8e1;
			}
			main .card.color-3 {
				background-color: #f5ccdc;
			}
			main .card.color-4 {
				background-color: #a9daad;
			}
			main .card.color-5 {
				background-color: #f17e61;
			}



	</style>

</head>

<body>

	<header><h1>scrībō</h1></header>

	<main>
	

		<div id="cards"></div>

		 <script type="text/template" id="card-template">
			<div class="card color-<%= color %>" style="top: <%= top %>px;left: <%= left %>px">
			 	<textarea><%= text %></textarea>
			</div>
		 </script>

			 

	</main>


</body>


</html>


<!-- 
user account
=facebok

-each user has "cards"



api

GET /cards/
GET /cards/12
PUT /cards {sdfd}
DELETE /cards -->