this.scribo=this.scribo||{},this.scribo.templates=this.scribo.templates||{},this.scribo.templates.card=Handlebars.template({1:function(a,b,c,d,e){return"flipped"},3:function(a,b,c,d,e,f,g){var h,i=a.lambda,j=a.escapeExpression;return'\t\t\t\t\t<li class="card-style-'+j(i(b,b))+'">\r\n\t\t\t\t\t\t<label>\r\n\t\t\t\t\t\t\t<input type="radio" name="card_style" value="'+j(i(b,b))+'" '+(null!=(h=(c.if_eq||b&&b.if_eq||c.helperMissing).call(null!=b?b:a.nullContext||{},null!=(h=null!=g[1]?g[1].card:g[1])?h.color:h,b,{name:"if_eq",hash:{},fn:a.program(4,e,0,f,g),inverse:a.noop,data:e}))?h:"")+" >\r\n\t\t\t\t\t\t\t<span></span>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</li>\r\n"},4:function(a,b,c,d,e){return"checked"},compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e,f,g){var h,i=a.lambda,j=a.escapeExpression,k=null!=b?b:a.nullContext||{};return'<div class="wrapper style-'+j(i(null!=(h=null!=b?b.card:b)?h.color:h,b))+" "+(null!=(h=c["if"].call(k,null!=b?b.isFlipped:b,{name:"if",hash:{},fn:a.program(1,e,0,f,g),inverse:a.noop,data:e}))?h:"")+'">\r\n\t<div class="front">\r\n\t\t<textarea placeholder="Type here...">'+j(i(null!=(h=null!=b?b.card:b)?h.text:h,b))+'</textarea>\r\n\t\t<a class="flip-card"></a>\r\n\t</div>\r\n\t<div class="back">\r\n\t\tSelect color:\r\n\t\t<form>\r\n\t\t\t<ul class="card-style">\r\n'+(null!=(h=c.each.call(k,null!=b?b.cardStyles:b,{name:"each",hash:{},fn:a.program(3,e,0,f,g),inverse:a.noop,data:e}))?h:"")+'\t\t\t</ul>\r\n\t\t</form>\r\n\t\t<a href="#" class="delete-card">Delete card</a><br />\r\n\t\t<a class="flip-card"></a>\r\n\t</div>\r\n</div>\t'},useData:!0,useDepths:!0}),this.scribo.templates.modal=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){return'<p><strong>Welcome to Scribo. The index card app for writers.</strong></p>\r\n<p>&middot; Click the " + " to create a new card</p>\r\n<p>&middot; Click the "<span class="icon">â¤¿</span>" for card options</p>\r\n<p>&middot; Drag to reorder the cards</p>\r\n<p>&middot; Cards are automatically saved</p>\r\n<p>Important: This is beta software. Things may break. Please don\'t make this the only copy of your precious work.</p>\r\n<p>And please let us know what you think <a href="mailto:feedback@scribo.co.">feedback@scribo.co</a>.</p>\r\n<p><a href="#" class="close-modal">Ok, got it</a></p>'},useData:!0}),this.scribo.templates.nav=Handlebars.template({compiler:[7,">= 4.0.0"],main:function(a,b,c,d,e){var f;return'<a href="#" class="toggle"></a>\r\n<div class="nav-content">\r\n\tLogged in as '+a.escapeExpression(a.lambda(null!=(f=null!=b?b.userProfile:b)?f.name:f,b))+'<br />\r\n\t<br />\r\n\t<form>\r\n\t\t<fieldset>\r\n\t\t\t<legend>Theme</legend>\r\n\t\t\t<label><input type="radio" name="theme" value="classic" checked> Classic</label>\r\n\t\t\t<label><input type="radio" name="theme" value="modern"> Modern</label>\r\n\t\t</fieldset>\r\n\t</form>\r\n\t<br /> \r\n\t<br />\r\n\t<a href="#" class="logout">Logout</a>\r\n</div>'},useData:!0});var scribo=scribo||{};$(function(){new scribo.AppView});var scribo=scribo||{};scribo.config=scribo.config||{},scribo.config.autosave_ms=5e3,Handlebars.registerHelper("if_eq",function(a,b,c){return a==b?c.fn(this):c.inverse(this)});var scribo=scribo||{};scribo.CardModel=Backbone.Model.extend({defaults:{color:1,text:"",order:0},idAttribute:"_id"}),scribo.CardCollection=Backbone.Collection.extend({model:scribo.CardModel,url:"/api/cards"});var scribo=scribo||{};scribo.userProfile=scribo.userProfile||{},scribo.AppView=Backbone.View.extend({el:$("main"),initialize:function(){_.bindAll(this,"updateOrder"),this.doAuth(),scribo.cards=new scribo.CardCollection,this.listenTo(scribo.cards,"add",this.addOne),this.listenTo(scribo.cards,"reset",this.addAll),scribo.cards.fetch({reset:!0}),this.$cards=this.$el.find("#cards"),this.makeSortable(),this.addNav(),localStorage.getItem("seenModal")||this.addModal()},events:{"click a.add-card":"addCard"},makeSortable:function(){var a=document.getElementById("cards");Sortable.create(a,{animation:300,draggable:"li.card",handle:".front",onEnd:this.updateOrder})},updateOrder:function(a){this.$cards.find("li.card").each(function(a,b){var c=scribo.cards.get($(b).data("id"));c.save("order",a+1)})},addCard:function(a){a.preventDefault(),scribo.cards.create()},addOne:function(a){var b=new scribo.CardView({model:a});this.$cards.append(b.render().el)},addAll:function(){scribo.cards.each(this.addOne,this)},addNav:function(){var a=new scribo.NavView;this.$el.append(a.render().el)},addModal:function(){var a=new scribo.ModalView;this.$el.append(a.render().el)},doAuth:function(){scribo.userProfile=JSON.parse(localStorage.getItem("userProfile")),scribo.userProfile||(window.location.href="/"),$.ajaxSetup({beforeSend:function(a){localStorage.getItem("userToken")&&a.setRequestHeader("Authorization","Bearer "+localStorage.getItem("userToken"))}})}});var scribo=scribo||{};scribo.config=scribo.config||{},scribo.templates=scribo.templates||{},scribo.CardView=Backbone.View.extend({tagName:"li",className:"card",cardStyles:[1,2,3,4,5],isFlipped:!1,attributes:function(){return{"data-id":this.model.id}},render:function(){return this.$el.html(scribo.templates.card({card:this.model.toJSON(),isFlipped:this.isFlipped,cardStyles:this.cardStyles})),this.$input=this.$el.find("textarea"),this.$wrapper=this.$el.find(".wrapper"),this},initialize:function(){this.listenTo(this.model,"destroy",this.remove),this.listenTo(this.model,"change:color",this.render),this.listenTo(this.model,"change:text",this.delayedSave)},events:{"keyup textarea":"updateCardText","click a.delete-card":"deleteCard",'change input[name="card_style"]':"setCardStyle","click a.flip-card":"flipCard"},updateCardText:function(){var a=this.$input.val()?this.$input.val():"";this.model.set({text:a})},deleteCard:function(a){a.preventDefault(),confirm("Are you sure you wish to delete this card?")&&this.model.destroy()},setCardStyle:function(a){this.model.save("color",$(a.target).val())},flipCard:function(a){this.isFlipped=!this.isFlipped,this.$wrapper.toggleClass("flipped",this.isFlipped)},delayedSave:_.debounce(function(){this.model.save()},scribo.config.autosave_ms)});var scribo=scribo||{};scribo.templates=scribo.templates||{},scribo.ModalView=Backbone.View.extend({tagName:"div",className:"modal",render:function(){return this.$el.html(scribo.templates.modal({})),this},events:{"click a.close-modal":"closeModal"},closeModal:function(a){a.preventDefault(),localStorage.setItem("seenModal",!0),this.remove()}});var scribo=scribo||{};scribo.templates=scribo.templates||{},scribo.userProfile=scribo.userProfile||{},scribo.NavView=Backbone.View.extend({tagName:"nav",render:function(){return this.$el.html(scribo.templates.nav({userProfile:scribo.userProfile})),this},events:{"click .toggle":function(a){a.preventDefault(),$("body").toggleClass("nav-open")},'change input[name="theme"]':function(a){$("body").toggleClass("modern","modern"===$(a.target).val()),$("body").toggleClass("classic","classic"===$(a.target).val())},"click .logout":function(a){a.preventDefault(),confirm("Are you sure you wish to log out?")&&(localStorage.removeItem("userToken"),localStorage.removeItem("userProfile"),window.location.href="/")}}});
//# sourceMappingURL=scribo.min.js.map